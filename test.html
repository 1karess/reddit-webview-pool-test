<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>LocalStorage Cross-App Test</title>
    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        padding: 16px;
        line-height: 1.5;
      }
      .row {
        margin: 10px 0;
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
      }
      button {
        padding: 10px 14px;
        border: 0;
        border-radius: 10px;
        background: #2d6cdf;
        color: #fff;
        font-weight: 650;
        cursor: pointer;
      }
      button.secondary {
        background: #6c757d;
      }
      #result {
        margin-top: 12px;
        padding: 12px;
        border: 1px solid #e5e5e5;
        border-radius: 10px;
        word-break: break-word;
      }
      code {
        background: #f6f8fa;
        padding: 2px 6px;
        border-radius: 6px;
      }
    </style>
  </head>
  <body>
    <h1>LocalStorage Cross-App Test</h1>
    <p>
      å½“å‰ Origin: <code id="origin"></code><br />
      Key: <code>tracker_id</code>
    </p>
    <p>
      æ¥è‡ªç½‘ç«™Açš„è·³è½¬å‚æ•° tid: <code id="tid">(none)</code>
      <br />
      <small>è¯´æ˜ï¼šè·¨åŸŸæ—¶ï¼Œç½‘ç«™Bè¯»ä¸åˆ°ç½‘ç«™Açš„ localStorage/cookieï¼›ä½†å¦‚æœ A æŠŠ ID æ”¾è¿› URL å‚æ•°ï¼ˆtidï¼‰ï¼ŒB å¯ä»¥è¯»å–å¹¶ç”¨äºâ€œè·¨åŸŸå…³è”â€ã€‚</small>
    </p>
    <p>
      <button class="secondary" onclick="saveTid()">æŠŠ tid ä¿å­˜åˆ°æœ¬åŸŸ localStorageï¼ˆlast_tidï¼‰</button>
    </p>

    <div class="row">
      <button onclick="writeId()">å†™å…¥ID</button>
      <button class="secondary" onclick="readId()">è¯»å–ID</button>
      <button class="secondary" onclick="clearId()">æ¸…é™¤ID</button>
    </div>

    <div id="result">ç­‰å¾…æ“ä½œâ€¦</div>

    <script>
      document.getElementById("origin").textContent = window.location.origin;
      const tid = new URLSearchParams(window.location.search).get("tid");
      document.getElementById("tid").textContent = tid || "(none)";

      function saveTid() {
        if (!tid) {
          document.getElementById("result").innerHTML = "âŒ å½“å‰ URL æ²¡æœ‰ tid å‚æ•°";
          return;
        }
        localStorage.setItem("last_tid", tid);
        document.getElementById("result").innerHTML = "âœ… å·²ä¿å­˜ last_tid: " + tid;
      }

      function writeId() {
        const id = "user_" + Date.now();
        localStorage.setItem("tracker_id", id);
        document.getElementById("result").innerHTML = "âœ… å†™å…¥: " + id;
      }

      function readId() {
        const id = localStorage.getItem("tracker_id");
        if (id) {
          document.getElementById("result").innerHTML =
            "ğŸ¯ è¯»åˆ°äº†: " + id + "<br>å¯èƒ½å­˜åœ¨è·¨APPå…±äº«!";
        } else {
          document.getElementById("result").innerHTML =
            "âŒ æ²¡è¯»åˆ°æ•°æ®<br>è·¨APPéš”ç¦»æ­£å¸¸";
        }
      }

      function clearId() {
        localStorage.removeItem("tracker_id");
        document.getElementById("result").innerHTML = "ğŸ—‘ï¸ å·²æ¸…é™¤ tracker_id";
      }
    </script>
  </body>
</html>
