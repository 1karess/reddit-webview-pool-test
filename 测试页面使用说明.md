# WebView 测试页面使用说明

## 📄 测试页面已创建

我已经创建了一个测试页面：`webview_test.html`

这个页面可以：
- ✅ 写入测试数据到 localStorage、sessionStorage、Cookie
- ✅ 读取并显示所有存储的数据
- ✅ 自动检测是否有数据残留
- ✅ 显示页面信息（URL、Origin 等）

---

## 🚀 使用方法

### 方法 1：通过本地服务器（推荐）

1. **启动服务器**：
   ```bash
   cd ~/Desktop/reddit-code
   ./启动测试服务器.sh
   ```

2. **获取 Mac 的 IP 地址**：
   - 服务器启动后会显示 IP 地址
   - 或者手动查看：`ifconfig | grep "inet " | grep -v 127.0.0.1`

3. **在手机上访问**：
   - 确保手机和 Mac 在同一个 Wi-Fi 网络
   - 在 Reddit App 中，想办法打开这个 URL：
     ```
     http://<你的Mac IP>:8000/webview_test.html
     ```
   - 例如：`http://192.168.1.100:8000/webview_test.html`

---

### 方法 2：通过 adb 推送（如果 App 支持 file:// 协议）

1. **推送文件到手机**：
   ```bash
   adb push ~/Desktop/reddit-code/webview_test.html /sdcard/Download/
   ```

2. **在 Reddit App 中打开**：
   - 如果 App 支持，可以尝试打开：`file:///sdcard/Download/webview_test.html`

---

### 方法 3：上传到在线服务

1. 把 `webview_test.html` 上传到：
   - GitHub Pages
   - Netlify
   - 或者其他静态网站托管服务

2. 获取公开 URL，在 Reddit App 中打开

---

## 📋 测试步骤

### 第 1 步：账号 A 测试

1. **在 Reddit App 中打开测试页面**
2. **点击"写入测试数据"**
   - 默认会写入：`test_account_A = account_A_data`
3. **点击"读取所有数据"**，确认数据已写入
4. **记录或截图**显示的数据
5. **关闭页面**（返回上一页）

### 第 2 步：切换到账号 B

1. **在 Reddit App 中退出账号 A**
2. **登录账号 B**
3. **等待几秒**，让 App 完全切换

### 第 3 步：账号 B 测试

1. **再次打开同一个测试页面**
2. **点击"读取所有数据"**
3. **检查是否还能看到账号 A 的数据**

### 第 4 步：分析结果

- ✅ **如果看不到账号 A 的数据**：说明数据被正确清理/隔离
- ⚠️ **如果还能看到账号 A 的数据**：说明存在跨账号数据残留风险

---

## 🎯 关键检查点

测试页面会自动检测并显示：
- localStorage 中的所有数据
- sessionStorage 中的所有数据
- Cookie 中的所有数据
- 页面信息（URL、Origin 等）

如果账号 B 还能看到账号 A 写入的数据，**说明存在 WebView Pool 跨账号数据泄露风险**。

---

## 💡 提示

如果 Reddit App 无法直接打开外部 URL，可以：
1. 先启动服务器
2. 告诉我你的 Mac IP 地址
3. 我帮你找其他方法在 App 中打开

或者，如果你有办法在 Reddit App 中打开任意 URL，直接访问测试页面即可。
